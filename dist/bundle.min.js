function e(e,t,i){if(0===t)return[];const n=Array(t-1).fill("").map((e=>{const t=function(e,t){const i=document.createElement("div");i.classList.add("sr-separator-anchor"),i.style.position="absolute",i.style.display="flex",i.style.justifyContent="center",i.style.top="0px",i.style.left="0px","horizontal"===e?(i.style.height="100%",i.style.width=t,i.style.flexDirection="row",i.style.transform=`translateX(calc(-${t} / 2))`,i.style.cursor="e-resize"):"vertical"===e&&(i.style.width="100%",i.style.height=t,i.style.flexDirection="column",i.style.transform=`translateY(calc(-${t} / 2))`,i.style.cursor="n-resize");const n=document.createElement("div");n.classList.add("sr-separator"),"horizontal"===e?n.style.height="100%":"vertical"===e&&(n.style.width="100%");return i.append(n),i}(i,"20px"),n=new Set;let s="idle";function a(e=!0){n.forEach((t=>t(e))),t.children[0].classList.toggle("sr-separator-highlight",e)}return t.addEventListener("pointerenter",(()=>{"idle"===s&&a(!0)})),t.addEventListener("pointerleave",(()=>{"idle"===s&&a(!1)})),{element:t,position:0,initial_position:0,update:function(e){"horizontal"===i?t.style.left=`calc(${e})`:t.style.top=`calc(${e})`},setState:function(e){s=e},setHighlight:a,on(e,t){"highlight"===e&&n.add(t)},off(e,t=null){"highlight"===e&&(null===t?n.clear():n.delete(t))}}}));return n.forEach((t=>e.append(t.element))),n}function t(e){return e.reduce(((e,t)=>e+t),0)}function i(e,i,s){i=(i=i.map(((t,i)=>null===t?null:Math.max(e[i].min_size,t)))).map(((t,i)=>null===t?null:Math.min(e[i].max_size,t)));const a=Math.max(Math.min(s,t(e.map((e=>e.max_size)))),t(e.map((e=>e.min_size)))),r=[];if(i=i.map(((t,i)=>null===t?(r.push(i),e[i].min_size):t)),r.length>0){let s=t(i);if(s<a){const t=a-s,o=n(i.filter(((e,t)=>r.includes(t))),e.map(((e,t)=>e.max_size-i[t])).filter(((e,t)=>r.includes(t))),t);let l=0;i=i.map(((e,t)=>r.includes(t)?(l++,o[l-1]):e))}}const o=t(i)-a;return o>0?i=function(e,i,n){const s=t(i),a=i.map((e=>n*(e/s)));return e.map(((e,t)=>e-a[t]))}(i,i.map(((t,i)=>t-e[i].min_size)),o):o<0&&(i=n(i,i.map(((t,i)=>e[i].max_size-t)),-o)),e.map(((e,t)=>Object.assign(Object.assign({},e),{cur_size:i[t]})))}function n(e,i,n){let s=n/i.length,a=0,r=i.map((e=>isFinite(e)?Math.min(s,e):(a++,s))),o=n-t(r);return a>0&&0!==o&&(s=o/a,r=r.map(((e,t)=>isFinite(i[t])?e:e+s)),o=n-t(r)),e.map(((e,t)=>e+r[t]))}function s(e,t,i){if(0===e.length)return{remaining:0,sections:e};let n=i?e.length-1:0;for(;0!=t&&(i?n>=0:n<e.length);){const s=e[n].max_size-e[n].ini_size,a=e[n].ini_size-e[n].min_size;t>0?t<s?(e[n].cur_size=e[n].ini_size+t,t=0):(e[n].cur_size=e[n].ini_size+s,t-=s):-t<a?(e[n].cur_size=e[n].ini_size+t,t=0):(e[n].cur_size=e[n].ini_size-a,t+=a),n+=i?-1:1}return{remaining:t,sections:e}}function a(e,t,i){let n=e.map((e=>Object.assign(Object.assign({},e),{cur_size:e.ini_size}))),a=n,r=i,o=0;for(;0!==r&&o<3;){o++;const l=s(n.slice(0,t+1),i,!0),c=s(n.slice(t+1),-i,!1);a=[...l.sections,...c.sections].map((e=>Object.assign({},e))),r=Math.abs(l.remaining)>=Math.abs(c.remaining)?l.remaining:-c.remaining,i-=r,n=e.map((e=>Object.assign(Object.assign({},e),{cur_size:e.ini_size})))}return a}const r=console.warn;function o(t,n={mode:"horizontal",resizeMode:"distributed"}){const s=(n=Object.assign(Object.assign({},{mode:"horizontal",resizeMode:"distributed"}),n)).mode,o=n.resizeMode;let l,c,m,u,d,h,p="x",g="width";function f(){const e=m.map((e=>e.cur_size/l*100+"%")).join(" ");"vertical"===s?(t.style.gridTemplateColumns="auto",t.style.gridTemplateRows=e):(t.style.gridTemplateRows="auto",t.style.gridTemplateColumns=e);const i=m.reduce(((e,t)=>[...e,e[e.length-1]+t.cur_size]),[0]).slice(1);u.forEach(((e,t)=>e.update(i[t]/l*100+"%")))}function z(e){const t="min"in e.dataset?Math.max(parseFloat(e.dataset.min),50):50,i="init"in e.dataset?Math.max(t,parseFloat(e.dataset.init)):null;return{element:e,min_size:t,max_size:"max"in e.dataset?Math.max(t,parseFloat(e.dataset.max)):Number.POSITIVE_INFINITY,def_size:i,cur_size:i,ini_size:i}}"vertical"===s?(p="y",g="height"):"horizontal"!==s&&r(`mode '${s}' is unknwon. Defaulting to 'horizontal'`),function(){l=t.getBoundingClientRect()[g],c=l,t.style.position="relative",t.style.overflow="auto",t.style.display="grid",t.style.padding="0",t.style.margin="0",document.addEventListener("pointerdown",v),document.addEventListener("pointermove",b),document.addEventListener("pointerup",w);const n=Array.from(t.children);m=n.map(z),u=e(t,n.length,s),m=i(m,m.map((e=>e.cur_size)),l),x(),f(),d=new ResizeObserver((e=>{const n=t.getBoundingClientRect()[g];if(n!==l)if(l=n,"left"!==o&&"right"!==o)m=i(m,m.map((e=>e.ini_size/l*n)),n);else{const e=l-c;"left"===o?m=a(m,-1,-e):"right"===o&&(m=a(m,m.length,e))}f(),window.requestAnimationFrame((()=>{f()}))})),d.observe(t),h=new MutationObserver((()=>{h.disconnect(),u.forEach((e=>e.element.remove()));const n=Array.from(t.children),a=m.reduce(((e,t)=>e+t.cur_size),0)/m.length;m=n.map((e=>{const t=m.findIndex((t=>t.element===e));if(-1===t){const t=z(e);return isNaN(a)||(t.cur_size=a),t}return Object.assign({},m[t])})),u=e(t,n.length,s),m=i(m,m.map((e=>e.cur_size)),l),f(),h.observe(t,{childList:!0,subtree:!1})})),h.observe(t,{childList:!0,subtree:!1})}();const _=document.createElement("style");function x(){m=m.map((e=>Object.assign(Object.assign({},e),{ini_size:e.cur_size}))),u=u.map(((e,t)=>(e.initial_position=e.element.getBoundingClientRect()[p],e))),c=l}let y;function v(e){x(),y=u.findIndex((t=>t.element===e.target||t.element.children[0]===e.target)),u.forEach((e=>e.setState("silent"))),y>=0&&(e.preventDefault(),u[y].setState("resizing"),u[y].setHighlight(!0),document.head.appendChild(_))}function b(e){if(y>=0){const t=e[p]-(u[y].initial_position+10);m=a(m,y,t),f()}}function w(){y>=0&&(x(),u[y].setHighlight(!1),y=-1,_.remove()),u.forEach((e=>e.setState("idle")))}function E(){return new Promise((e=>{requestAnimationFrame((()=>{e()}))}))}return _.media="screen",_.textContent=`* {cursor: ${"vertical"===s?"n-resize":"e-resize"} !important}`,{configure:function(e){return Array.isArray(e)||(e=m.map(((t,i)=>Object.assign({index:i},e)))),e.forEach((e=>{void 0!==e.index&&e.index>=0&&e.index<m.length&&(e.min&&(m[e.index].min_size=Math.max(50,e.min)),e.max&&(m[e.index].max_size=Math.max(0,e.max)))})),m=i(m,m.map((e=>e.cur_size)),l),f(),x(),E()},resize:function(e){const t=m.map((e=>null));return e.forEach((e=>{void 0!==e.index&&e.index>=0&&e.index<m.length&&void 0!==e.size&&(t[e.index]=e.size)})),m=i(m,t,l),f(),x(),E()},getSections:function(){return m}}}export{o as default};
